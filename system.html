<template name="main">
    <div class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <a href="../" class="navbar-brand">Supplier Management System</a>
                <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            {{#if currentUser}}
                <div class="navbar-collapse collapse" id="navbar-main">
                    <ul class="nav navbar-nav">
                        {{#if isInRole 'admin'}}
                            <li>
                                <a href="{{pathFor route='companies'}}">Companies</a>
                            </li>
                        {{/if}}
                        {{#if isInRole 'supplier'}}
                            <li>
                                <a href="/companies/newCompany">Company Registration</a>
                            </li>
                        {{/if}}
                        {{#if isInRole 'admin, employee'}}
                            <li>
                                <a href="{{pathFor route='events'}}">Events</a>
                            </li>
                        {{/if}}
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <li class="logout">
                            <a href="{{pathFor route='home'}}">Logout</a>
                        </li>
                    </ul>
                </div>
            {{/if}}
        </div>
    </div>
    <br>
    <br>
    <br>
    <br>

    <div class="container">
        {{> yield}}

    </div>

    <div class="container">
        <footer>
            <center>Copyright 2015-2016</center>
        </footer>
    </div>
</template>

<template name="login">
    <center>
        <img src="/TL_Logo.png" alt="Logo" width="400" height="194" align="middle">
        <br>
        <br>
        <br>
        <br>

        <div class="container">
            <form class="form-horizontal">
                <div class="form-group">
                    <label class="col-md-5 control-label"></label>
                    <label for="loginUsername" class="sr-only col-md-5">Username</label>

                    <div class="col-md-2">
                        <input type="text" class="form-control" name="loginUsername" id="loginUsername"
                               placeholder="Username">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-5 control-label"></label>
                    <label for="loginUsername" class="sr-only col-md-5">Password</label>

                    <div class="col-md-2">
                        <input type="password" class="form-control" name="loginPassword" id="loginPassword"
                               placeholder="Password">
                    </div>
                </div>
                <input type="submit" class="btn btn-lg btn-primary" name="submit" id="submit" value="Sign In">
            </form>
        </div>

    </center>
</template>

<template name="home">
    {{#if currentUser}}
        <center>
            <img src="/TL_Logo.png" alt="Logo" width="400" height="194" align="middle"><br>
        </center>
    {{else}}
        {{> login}}
    {{/if}}
</template>

<template name="navigation">
    <ul>
        <a href="{{pathFor route='home'}}">Home</a>
        {{#if currentUser}}
            {{#if isInRole 'admin'}}
                <a href="{{pathFor route='companies'}}">Companies</a>
            {{/if}}
            {{#if isInRole 'admin,employee'}}
                <a href="{{pathFor route='events'}}">Events</a>
            {{/if}}
            {{#if isInRole 'supplier'}}
                <a href="{{pathFor route='register'}}">New Company</a>
            {{/if}}
            <a href="#" class="logout">Logout</a>

        {{else}}
            <a href="{{pathFor route='login'}}">Login</a>
        {{/if}}

    </ul>
</template>

<template name="companies">
    {{#if currentUser}}
        {{#if isInRole 'admin'}}
            <div class="container">
                <h1>Companies</h1><br><br>
                <input type="button" class="btn btn-success" value="+ ADD NEW"
                       onclick="window.location.href='/companies/newCompany'">
                <input type="button" class="btn btn-info" value="Send All Feedback"><br><br>
                {{> companyListDisplay}}
                <br>
                <input type="email" class="form-control-static" name="emailInvite" id="emailInvite"><input type="button"
                                                                                                           class="btn btn-warning"
                                                                                                           value="Send Invitation">

            </div>
        {{/if}}
    {{else}}
        {{redirect}}
    {{/if}}
</template>

<template name="companyListDisplay">
    {{#if currentUser}}
        <div class="row">
            <div class="col-md-12">
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>Company Name</th>
                        <th>Sales Name</th>
                        <th>Sales Phone</th>
                        <th>Sales E-Mail</th>
                        <th></th>

                    </tr>
                    </thead>
                    <tbody>
                    {{#each company}}
                        <tr class="company">
                            <td>{{companyName}}</td>
                            <td>{{salesPerson.name}}</td>
                            <td>{{salesPerson.phone}}</td>
                            <td>{{salesPerson.email}}</td>
                            <td>
                                <input type="button" class="btn btn-info" value="Send Feedback">
                                <input type="button" class="btn btn-warning" value="Edit">
                                <input type="button" class="btn btn-danger" value="Remove"></td>
                        </tr>
                    {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
    {{/if}}
</template>

<template name="addCompanyForm">
    {{#if currentUser}}
        {{#if isInRole 'admin, supplier'}}
            {{> insertCompanyForm}}

        {{/if}}
    {{/if}}
</template>

<template name="insertCompanyForm">
    {{#autoForm schema="CompaniesSchema" id="insertCompanyForm" type="insert" collection="CompaniesTest" resetOnSuccess=false}}

        {{> afQuickField name='companyName'}}
        {{> afQuickField name='companyAddress'}}
        {{> afQuickField name='salesPerson'}}
        {{> afQuickField name='qualityPerson'}}
        {{> afQuickField name='logisticsPerson'}}
        {{> afQuickField name='differentPerson'}}

        {{> afQuickField name='itemDescription'}}
        {{> afQuickField name='certification'}}
        <div class="form-group">
            <button type="submit" class="btn btn-primary">Submit</button>
            <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Cancel</button>
        </div>

    {{/autoForm}}
</template>

<template name="detailCompany">
    {{#if currentUser}}
        {{#autoForm schema="CompaniesSchema" id="insertCompanyForm" type="readonly" collection="CompaniesTest" doc=this resetOnSuccess=false}}
            <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Back</button>
            <fieldset>
                {{> afQuickField name='companyName'}}
                {{> afQuickField name='companyAddress'}}
                {{> afQuickField name='salesPerson'}}
                {{> afQuickField name='qualityPerson'}}
                {{> afQuickField name='logisticsPerson'}}
                {{> afQuickField name='differentPerson'}}
                {{> afQuickField name='itemDescription'}}
                {{> afQuickField name='certification'}}
                <h1>Events</h1><br>
                {{> companyEventListDisplay}}
                <div class="form-group">
                    <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Back</button>
                </div>
            </fieldset>
        {{/autoForm}}

    {{/if}}
</template>

<template name="editCompany">
    {{#if currentUser}}
        {{#if isInRole 'admin, supplier'}}
            {{#autoForm schema="CompaniesSchema" id="updateCompanyForm" type="update" collection="CompaniesTest" doc=this resetOnSuccess=false}}
                <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Back</button>
                <fieldset>
                    {{> afQuickField name='companyName'}}
                    {{> afQuickField name='companyAddress'}}
                    {{> afQuickField name='salesPerson'}}
                    {{> afQuickField name='qualityPerson'}}
                    {{> afQuickField name='logisticsPerson'}}
                    {{> afQuickField name='differentPerson'}}
                    {{> afQuickField name='itemDescription'}}
                    {{> afQuickField name='certification'}}
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">Submit</button>
                        <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Back</button>
                    </div>

                </fieldset>
            {{/autoForm}}
        {{/if}}
    {{/if}}
</template>

<template name="events">
    {{#if currentUser}}
        {{#if isInRole 'admin,employee'}}
            <div class="container">
                <h1>Events</h1><br><br>
                <input type="button" class="btn btn-success" value="+ ADD NEW"
                       onclick="window.location.href='/events/newEvent'"><br><br>
                {{> eventListDisplay}}
            </div>
        {{/if}}
    {{/if}}
</template>

<template name="eventListDisplay">
    {{#if currentUser}}
        <div class="row">
            <div class="col-md-12">
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>Date</th>
                        <th>CAR #</th>
                        <th>Company Name</th>
                        <th>Type</th>
                        <th>Status</th>
                        {{#if isInRole 'admin'}}
                            <th></th>
                        {{/if}}
                    </tr>
                    </thead>
                    <tbody>
                    {{#each event}}
                        {{#if eventBad}}
                            <tr class="event danger">
                                <td>{{index}}</td>
                                <td>{{eventDate}}</td>
                                <td>{{carNumber}}</td>
                                <td>{{companyName}}</td>
                                <td>{{eventType}}</td>
                                <td>{{statusOptionConverter}}</td>
                                {{#if isInRole 'admin'}}
                                    <td>
                                        <input type="button" class="btn btn-warning" value="Edit"
                                               onclick="window.location.href='/events/edit/{{_id}}'">
                                        <input type="button" class="btn btn-danger" value="Remove"></td>
                                {{/if}}
                            </tr>
                        {{/if}}
                        {{#if eventMid}}
                            <tr class="event warning">
                                <td>{{index}}</td>
                                <td>{{eventDate}}</td>
                                <td>{{carNumber}}</td>
                                <td>{{companyName}}</td>
                                <td>{{eventType}}</td>
                                <td>{{statusOptionConverter}}</td>
                                {{#if isInRole 'admin'}}
                                    <td>
                                        <input type="button" class="btn btn-warning" value="Edit"
                                               onclick="window.location.href='/events/edit/{{_id}}'">
                                        <input type="button" class="btn btn-danger" value="Remove"></td>
                                {{/if}}
                            </tr>
                        {{/if}}
                        {{#if eventGood}}
                            <tr class="event success">
                                <td>{{index}}</td>
                                <td>{{eventDate}}</td>
                                <td>{{carNumber}}</td>
                                <td>{{companyName}}</td>
                                <td>{{eventType}}</td>
                                <td>{{statusOptionConverter}}</td>
                                {{#if isInRole 'admin'}}
                                    <td>
                                        <input type="button" class="btn btn-warning" value="Edit"
                                               onclick="window.location.href='/events/edit/{{_id}}'">
                                        <input type="button" class="btn btn-danger" value="Remove"></td>
                                {{/if}}
                            </tr>
                        {{/if}}
                    {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
    {{/if}}
</template>

<template name="companyEventListDisplay">
    {{#if currentUser}}
        <div class="row">
            <div class="col-md-10">
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>Date</th>
                        <th>CAR #</th>
                        <th>Type</th>
                        <th>Status</th>
                    </tr>
                    </thead>
                    <tbody>
                    {{#each event}}
                        {{#if eventBad}}
                            <tr class="event danger">
                                <td>{{index}}</td>
                                <td>{{eventDate}}</td>
                                <td>{{carNumber}}</td>
                                <td>{{eventType}}</td>
                                <td>{{statusOptionConverter}}</td>


                            </tr>
                        {{/if}}
                        {{#if eventMid}}
                            <tr class="event warning">
                                <td>{{index}}</td>
                                <td>{{eventDate}}</td>
                                <td>{{carNumber}}</td>
                                <td>{{eventType}}</td>
                                <td>{{statusOptionConverter}}</td>
                            </tr>
                        {{/if}}
                        {{#if eventGood}}
                            <tr class="event success">
                                <td>{{index}}</td>
                                <td>{{eventDate}}</td>
                                <td>{{carNumber}}</td>
                                <td>{{eventType}}</td>
                                <td>{{statusOptionConverter}}</td>

                            </tr>
                        {{/if}}
                    {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
    {{/if}}
</template>

<template name="addEventForm">
    {{#if currentUser}}
        {{#if isInRole 'admin,employee'}}
            {{> insertEventForm}}
        {{/if}}
    {{/if}}
</template>

<template name="addQualityEventForm">
    {{#if currentUser}}
        {{#if isInRole 'admin,employee'}}
            <form>
                <div class="form-group">
                    <label class="col-sm-2 control-label">Quantity Rejected</label>

                    <div class="col-sm-4">
                        <input type="number" class="form-control" id="quantityReject" name="quantityReject">
                    </div>
                </div>
            </form>
        {{/if}}
    {{/if}}
</template>

<template name="addDeliveryEventForm">
    {{#if currentUser}}
        {{#if isInRole 'admin,employee'}}
            <form>
                <div class="form-group">
                    <label class="col-sm-2 control-label">Required Delivery Date</label>

                    <div class="col-sm-4">
                        <input type="date" class="form-control" id="requiredDeliveryDate" name="requiredDeliveryDate">
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-sm-2 control-label">Actual Delivery Date</label>

                    <div class="col-sm-4">
                        <input type="date" class="form-control" id="actualDeliveryDate" name="actualDeliveryDate">
                    </div>
                </div>
            </form>
        {{/if}}
    {{/if}}
</template>

<template name="detailEvent">
    {{#if currentUser}}
        {{#autoForm schema="EventSchema" id="insertEventForm" type="readonly" collection="EventsTest" doc=this resetOnSuccess=false}}
            <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Back</button>
            <fieldset>
                {{> afQuickField name='companyName'}}
                {{> afQuickField name='eventDate'}}
                {{> afQuickField name='eventType'}}
                {{> afQuickField name='tlPartNumber'}}
                {{> afQuickField name='purchaseOrderNumber'}}
                {{> afQuickField name='lotNumber'}}
                {{> afQuickField name='carNumber'}}
                {{#if showDelivery}}
                    {{> afQuickField name='requiredDate'}}
                    {{> afQuickField name='actualDate'}}
                {{else}}
                    {{> afQuickField name='quantityReject'}}
                {{/if}}
                {{> afQuickField name='rootCause'}}
                {{> afQuickField name='statusOption'}}

                <div class="form-group">
                    <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Back</button>
                </div>

            </fieldset>
        {{/autoForm}}

    {{/if}}
</template>

<template name="editEvent">
    {{#if currentUser}}

        {{#if isInRole 'admin, supplier'}}
            {{#autoForm schema="EventSchema" id="updateEventForm" type="update" collection="EventsTest" doc=this resetOnSuccess=false}}
                <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Back</button>
                <fieldset>
                    {{> afQuickField name='companyName'}}
                    {{> afQuickField name='eventDate'}}
                    {{> afQuickField name='eventType'}}
                    {{> afQuickField name='tlPartNumber'}}
                    {{> afQuickField name='purchaseOrderNumber'}}
                    {{> afQuickField name='lotNumber'}}
                    {{> afQuickField name='carNumber'}}
                    {{#if showDelivery}}
                        {{> afQuickField name='requiredDate'}}
                        {{> afQuickField name='actualDate'}}
                    {{else}}
                        {{> afQuickField name='quantityReject'}}
                    {{/if}}
                    {{> afQuickField name='rootCause'}}
                    {{> afQuickField name='statusOption'}}

                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">Submit</button>
                        <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Back</button>
                    </div>

                </fieldset>
            {{/autoForm}}

        {{/if}}
    {{/if}}
</template>

<template name="register">
    {{> loginButtons}}
    <h2>Register</h2><br>

    <form class="register">
        <p>Username: <input type="text" name="username"></p><br>

        <p>Password: <input type="password" name="password"></p><br>

        <p><input type="submit" value="Register"></p>
    </form>
</template>

<template name="registerEmail">
    To our Valued Suppliers,
    <br><br>

    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We have developed a web-based tool that has been designed to help us collect supplier
    profile data and also automate performance feedback to our suppliers on a quarterly basis. This system will require
    that you designate a point person to submit the information requested and also be the recipient of the quality and
    delivery performance feedback that we will send to your designated staff each quarter via email.<br><br>

    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We ask that you take approximately 5 minutes to fill out the profile survey and
    submit it to us within the next week. Follow the instructions below to access the T&L Supplier site and submit
    the profile for your company. Thank you in advance for your support.<br><br>

    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. Go to <a href="http://107.170.167.85/">Supplier Registration</a><br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. Enter the login information given below<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a. Username: supplier<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b. Password: apple1<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. Fill out the profile survey<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. Click the Submit Button<br><br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Once you have registered, you will be logged out automatically and your company will
    be able to receive quarterly performance
    feedback.<br><br>
    Sincerely,<br>
    <b>William J. Green</b><br>
    Vice President - Sales and Marketing<br>
    <img src="http://i.imgur.com/p4NrWee.png" alt="Logo" height="95" width="144"><br>

    <p><i><b>Improving….Never done!!</b></i></p><br>
    770 Emerson Street<br>
    770 Emerson Street<br>
    Rochester, NY 14613<br>
    Office 585 647-3717<br>
    Fax 585 647-1126<br>
    <a href="www.tandlautomatics.com">www.tandlautomatics.com</a><br>
</template>

<template name="feedbackEmail">
    Dear Valued T&L Supplier,
    <br><br>

    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attached you will find your delivery and quality performance summary report for the
    prior quarter. Please review the information and contact Dan Barnhoorn if you have any questions
    Thank you for your ongoing support.<br><br>

    <div class="row">
        <div class="col-md-10">
            <table class="table table-striped table-hover" align="center">
                <thead>
                <tr>
                    <th>Date</th>
                    <th>CAR #</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Problem Description</th>
                </tr>
                </thead>
                <tbody>
                <tr></tr>
                {{#each eventItems}}
                    {{#if eventBad}}
                        <tr class="event danger" bgcolor="#ff3300">
                            <td>{{eventDate}}</td>
                            <td>{{carNumber}}</td>
                            <td>{{eventType}}</td>
                            <td>{{statusOptionConverter}}</td>
                            <td>{{rootCause}}</td>

                        </tr>
                    {{/if}}
                    {{#if eventMid}}
                        <tr class="event warning" bgcolor="#feff00">
                            <td>{{eventDate}}</td>
                            <td>{{carNumber}}</td>
                            <td>{{eventType}}</td>
                            <td>{{statusOptionConverter}}</td>
                            <td>{{rootCause}}</td>
                        </tr>
                    {{/if}}
                    {{#if eventGood}}
                        <tr class="event success" bgcolor="#00ff00">
                            <td>{{eventDate}}</td>
                            <td>{{carNumber}}</td>
                            <td>{{eventType}}</td>
                            <td>{{statusOptionConverter}}</td>
                            <td>{{rootCause}}</td>
                        </tr>
                    {{/if}}
                {{/each}}
                </tbody>
            </table>
        </div>
    </div>
    <br><br>
    Your current status is
    {{#if green}}
    <font color="#00ff00"><b>GREEN</b></font>
    {{/if}}
    {{#if yellow}}
        <font color="#feff00"><b>YELLOW</b></font>
    {{/if}}
    {{#if red}}
        <font color="#ff3300"><b>RED</b></font>
    {{/if}}
    <br><br>
    Sincerely,<br>
    <b>William J. Green</b><br>
    Vice President - Sales and Marketing<br>
    <img src="http://i.imgur.com/p4NrWee.png" alt="Logo" height="95" width="144"><br>

    <p><i><b>Improving….Never done!!</b></i></p><br>
    770 Emerson Street<br>
    Rochester, NY 14613<br>
    Office 585 647-3717<br>
    Fax 585 647-1126<br>
    <a href="www.tandlautomatics.com">www.tandlautomatics.com</a><br>
</template>

<template name="insertEventForm">
    {{#autoForm schema="EventSchema" id="insertEventForm" type="insert" collection="EventsTest" resetOnSuccess=false}}
        <fieldset>
            {{> afQuickField name='companyName'}}
            {{> afQuickField name='eventDate'}}
            {{> afQuickField name='eventType'}}
            {{> afQuickField name='tlPartNumber'}}
            {{> afQuickField name='purchaseOrderNumber'}}
            {{> afQuickField name='lotNumber'}}
            {{> afQuickField name='carNumber'}}
            {{#if showDelivery}}
                {{> afQuickField name='requiredDate'}}
                {{> afQuickField name='actualDate'}}
            {{else}}
                {{> afQuickField name='quantityReject'}}
            {{/if}}
            {{> afQuickField name='rootCause'}}
            {{> afQuickField name='statusOption'}}
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Submit</button>
                <button type="button" class="btn btn-danger" onclick="history.go(-1);return true;">Cancel</button>
            </div>
        </fieldset>
    {{/autoForm}}
</template>